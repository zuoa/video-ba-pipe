# ============================================
# Video BA Pipe 配置文件示例
# 复制此文件为 .env 并根据需要修改配置
# ============================================

# ============ 数据库配置 ============
# 数据库文件路径
DB_PATH=./app/data/db/ba.db

# ============ 存储路径配置 ============
# 预警图片保存路径
FRAME_SAVE_PATH=./app/data/frames

# 预警视频保存路径
VIDEO_SAVE_PATH=./app/data/videos

# 快照保存路径
SNAPSHOT_PATH=./app/data/snapshots

# ============ 快照配置 ============
# 是否启用定时快照功能
SNAPSHOT_ENABLED=true

# 快照间隔（秒）
SNAPSHOT_INTERVAL=60

# ============ 解码器配置 ============
# 极速解码模式（丢弃中间帧，只取最新帧）
IS_Extreme_DECODE_MODE=false

# ============ 视频录制配置 ============
# 预警录制功能开关
RECORDING_ENABLED=true

# 录制预警前的时长（秒）
# 建议：10-60秒
# 注意：不能超过RINGBUFFER_DURATION
PRE_ALERT_DURATION=30

# 录制预警后的时长（秒）
# 建议：10-60秒
POST_ALERT_DURATION=30

# 录制视频的帧率（FPS）
# 建议：5-15fps
# 说明：帧率越高视频越流畅，但占用存储和CPU更多
# - 5fps：适合资源受限环境，视频略有卡顿
# - 10fps：推荐值，平衡流畅度和资源占用
# - 15fps：较流畅，适合高性能服务器
RECORDING_FPS=10

# RingBuffer缓冲时长（秒）
# 建议：PRE_ALERT_DURATION + 20秒
# 说明：必须大于等于PRE_ALERT_DURATION才能录制到完整的历史视频
# 内存占用 ≈ 帧大小(字节) × FPS × 缓冲时长
# 例如：1920×1080×3 × 10 × 60 ≈ 3.6GB
RINGBUFFER_DURATION=60

# ============ 告警抑制配置 ============
# 告警抑制时长（秒）
# 说明：同一任务的同一算法在此时间内不会重复触发告警
# 建议：30-120秒，防止频繁告警和重复录制
# 例如：设置为60秒，则告警触发后60秒内检测到相同类型目标也不会再次告警
ALERT_SUPPRESSION_DURATION=60

# ============ RabbitMQ配置 ============
# 是否启用RabbitMQ预警发布功能
RABBITMQ_ENABLED=false

# RabbitMQ服务器配置
RABBITMQ_HOST=localhost
RABBITMQ_PORT=5672
RABBITMQ_USER=guest
RABBITMQ_PASSWORD=guest
RABBITMQ_VHOST=/

# 预警消息队列配置
RABBITMQ_ALERT_QUEUE=video_alerts
RABBITMQ_ALERT_EXCHANGE=video_alerts
RABBITMQ_ALERT_ROUTING_KEY=alert

# Topic模式配置（支持多消费者订阅）
# 可选值: topic（广播模式，一个消息多个消费者）, direct（点对点模式，一个消息一个消费者）
RABBITMQ_EXCHANGE_TYPE=topic
RABBITMQ_ALERT_TOPIC_PATTERN=video.alert.*

# RabbitMQ连接超时设置（秒）
RABBITMQ_CONNECTION_TIMEOUT=30

# ============ 性能参考 ============
# 
# 配置方案1（推荐 - 标准监控）:
# RECORDING_FPS=10
# RINGBUFFER_DURATION=60
# PRE_ALERT_DURATION=30
# POST_ALERT_DURATION=30
# 内存占用：~3.6GB (1920×1080)
# 视频时长：60秒
# 文件大小：~20-40MB/视频
#
# 配置方案2（高质量）:
# RECORDING_FPS=15
# RINGBUFFER_DURATION=90
# PRE_ALERT_DURATION=45
# POST_ALERT_DURATION=45
# 内存占用：~8GB (1920×1080)
# 视频时长：90秒
# 文件大小：~40-80MB/视频
#
# 配置方案3（资源受限）:
# RECORDING_FPS=5
# RINGBUFFER_DURATION=45
# PRE_ALERT_DURATION=20
# POST_ALERT_DURATION=20
# 内存占用：~1.3GB (1920×1080)
# 视频时长：40秒
# 文件大小：~8-15MB/视频

